<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ä¸­é‡åŒºè­°ä¼šè­°å“¡é¸æŒ™2023ï½œå­è‚²ã¦ä¸–ä»£ã«ã‚ˆã‚‹å¸‚æ°‘ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ"> 
    <meta name="keywords" content="ä¸­é‡åŒº,é¸æŒ™,å­è‚²ã¦ç’°å¢ƒå‘ä¸Šå§”å“¡ä¼š,ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ">
    <link rel="icon" href="pic/favicon.png">
    <meta property="og:image" content="pic/top_sumaho.png">
    <link rel="stylesheet" href="css/style_senkyo.css">

    
</head>
<body>
    <header id="header">
        <!--headerãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å‘¼ã³å‡ºã™é–¢æ•°ã«å¤‰æ›´ã™ã‚‹ã“ã¨ -->
           
        <div id="header_image">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100%" height="100%" preserveAspectRatio="none">
                <path d="M 20 50 C 20 0, 95 0, 95 50 C 95 100, 20 100, 20 50" fill="#eee"></path>
                <path d="M 15 80 L 28 60 L45 65 Z" fill="#eee"></path>            
            </svg>
            <p>2023å¹´ ä¸­é‡åŒº åŒºè­°é¸</p>
            <h1>å­è‚²ã¦æ”¿ç­–ã€èã„ã¦ã¿ãŸï¼</h1> 
        </div>
        <nav class="header_menu">
            <a href="index.html" class="menu_item"><span>å€™è£œè€…</span><span>ä¸€è¦§</span></a>
            <a href="compare.html" class="menu_item">è³ªå•ã”ã¨ã«æ¯”è¼ƒã™ã‚‹</a>               
            <!--<a href="early_voting_map.html" class="menu_item"><span>æœŸæ—¥å‰</span><span>æŠ•ç¥¨ã«ã¤ã„ã¦</span></a>
            <a href="" class="menu_item"><span>æŠ•ç¥¨æ‰€</span><span>ã«ã¤ã„ã¦</span></a>-->            
            <a href="about_us.html" class="menu_item">About us</a>                        
        </nav>
    
    </header>
    <main>
    
    <div id="contents">
    <h2 id="selected_candidate_name"><!--ã“ã“ã«é¸æŠã—ãŸå€™è£œè€…ã®åå‰ã‚’å‡ºåŠ›--></h2>

    </div>
    </main>
    <script>
   
        

        //ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœãŒè¨˜è¼‰ã•ã‚ŒãŸGoogleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã‚€ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è¨­å®šã‚’å¤‰æ›´ã—ã€URLã‚’CSVã®ã‚‚ã®ã«ä¿®æ­£ã—ãŸã‚‚ã®ã‚’ä¸‹è¨˜ã«è¨˜ã™ã‚‹ã€‚
        const CSV_dataPath = 'https://docs.google.com/spreadsheets/d/1jcLZ4O03c38yji9oBFbZoOBpK7WmQi5lUSyWR764YNE/gviz/tq?tqx=out:csv&sheet=Sheet1';

        
        //ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®åˆ—ã‚’æŒ‡å®š(ä¸€ç•ªå·¦ã®åˆ—ã‚’0ç•ªç›®ã¨ã—ã¦æ•°ãˆã‚‹)
        CANDIDATE_NAME = 2; //å€™è£œè€…åå‰ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®Cåˆ—ï¼‰(ä¸€ç•ªå·¦ã®åˆ—ã¯0ç•ªç›®)
        PARTY = 4;//æ”¿å…š 
        WEBSIATE = 6;//å„å€™è£œè€…ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ
        TWITTER = 7;//å„å€™è£œè€…ã®Twitter
        CANDIDATE_NO = 0;//å€™è£œè€…No
        Q1 = 9//è³ªå•ï¼‘
        A1 = 10;//è³ªå•ï¼‘ã®ç­”ãˆ
        IMG_SRC = 23;//å†™çœŸ
        SHEET = 25;//æœ‰æ¨©è€…ã‹ã‚‰ã®è³ªå•ã¸ã®è¿½åŠ å›ç­”ãŒè¨˜è¼‰ã•ã‚ŒãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URL
           
        getCSVDataAndConvertToArray(CSV_dataPath);//ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®csvãƒ‡ãƒ¼ã‚¿ã‚’Arrayã«å¤‰æ›â‡’åãå‡ºã—ãŸArrayã¯ã€ŒSURVAY_RESULT_ARRAYã€
        
        create_candidate_profile_details(SURVAY_RESULT_ARRAY);

        
         
        function create_candidate_profile_details(SURVAY_RESULT_ARRAY){

            //URLã®ã‚¯ã‚¨ãƒªãƒ¼æ–‡å­—åˆ—ã‹ã‚‰å€™è£œè€…ã®åå‰ã€å€™è£œè€…No(ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½•è¡Œç›®ã‹)ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
            let query_params = new URLSearchParams(document.location.search.substring(1));
            let q_name = query_params.get("name"); // 
            let q_no = parseInt(query_params.get("no"), 10); //10é€²æ•°ã§æ•°å€¤ã‚’å–å¾—

            //å€™è£œè€…åå‰
            let h2 =document.getElementById("selected_candidate_name");
            h2.textContent=q_name;

            //é¡”å†™çœŸ
            let image = document.createElement('img');
            image.src = 'pic/' + SURVAY_RESULT_ARRAY[q_no][IMG_SRC];
            //image.src = 'pic/kugi' + q_no + ".jpg";
            let div =document.getElementById("contents");
            div.appendChild(image);
            div.appendChild( document.createElement( 'br' ) );

            //æ®‹ã‚Šã®è³ªå•ï¼†å›ç­”
            const div_3=document.createElement("div");
            div_3.setAttribute("id","questions2_4");
            div.appendChild(div_3);

            for(let i = 9; i < 23; i++){
                let div_2 =document.createElement("div");
                div_2.setAttribute("class","style_"+ [i]);
                div_2.setAttribute("id","style_"+ [i]);
                let p = document.createElement("p");                
                p.innerText=(SURVAY_RESULT_ARRAY[q_no][i]);
                div_3.appendChild(div_2).appendChild(p);
            }

            //æœ‰æ¨©è€…ã‹ã‚‰ã®è³ªå•ã¸ã®è¿½åŠ å›ç­”ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼‰
            if(SURVAY_RESULT_ARRAY[q_no][SHEET] != null){
            const sheet = document.createElement('a');
            sheet.setAttribute('href',SURVAY_RESULT_ARRAY[q_no][SHEET]);
            sheet.setAttribute("target","_blank");
            sheet.setAttribute("class","style_s");
            const sheetText=document.createTextNode("ğŸ‘‰æœ‰æ¨©è€…ã‹ã‚‰ã®è³ªå•ã¸ã®è¿½åŠ å›ç­”ã¯ã“ã¡ã‚‰ï¼ˆâ‡ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨åˆ¥ã®ãƒšãƒ¼ã‚¸ãŒé–‹ãã¾ã™ï¼‰");
            const parent = document.getElementById("questions2_4");
            const reference =document.getElementById("style_21");
            parent.insertBefore(sheet,reference);
            sheet.appendChild(sheetText);}
        }

         



        //ä»¥ä¸‹ã€jsãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦åˆ†é›¢ã™ã‚‹ã“ã¨ï¼ï¼

        function getCSVDataAndConvertToArray(CSV_dataPath) {
        // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—åˆ—ã¨ã—ã¦å–å¾—
        let srt = new XMLHttpRequest();//ã‚µãƒ¼ãƒãƒ¼ã¨å¯¾è©±
        
        srt.open("GET", CSV_dataPath, false);//ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ(CSVç‰ˆ)ã‚’èª­ã¿è¾¼ã‚€ã€‚å€¤ãŒ false ã®å ´åˆã€ send() ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã™ã‚‹ã¾ã§æˆ»ã‚Šã¾ã›ã‚“ã€‚
            try {
                srt.send(null);
                SURVAY_RESULT_ARRAY = CSVToArray( srt.responseText, ',' );//ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
                console.log(SURVAY_RESULT_ARRAY); 
            } catch (err) {
            console.log(err);
            }
        }

        
        
        
        
        // This will parse a delimited string into an array of
	    // arrays. The default delimiter is the comma, but this
	    // can be overriden in the second argument.
	    function CSVToArray( strData, strDelimiter ){//æ³¨ã€Œ\r\nã€ãªã©ã¯å‡¦ç†ã§ããªã„ã®ã§ã€DOMã®éš›ã«å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
		
        // Check to see if the delimiter is defined. If not,
		// then default to comma.
		strDelimiter = (strDelimiter || ",");//è«–ç†å’Œ (||) æ¼”ç®—å­ (è«–ç†çš„åˆ†å‰²) ã‚’ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã®çµ„ã¿åˆã‚ã›ã«å¯¾ã—ã¦ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã®ã†ã¡ 1 ã¤ä»¥ä¸ŠãŒ true ã§ã‚ã‚‹å ´åˆã« true ã«ãªã‚Šã¾ã™ã€‚

		// Create a regular expression to parse the CSV values.
		var objPattern = new RegExp(//RegExp ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç…§åˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
			(
				// Delimiters.
				"(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +

				// Quoted fields.
				"(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +

				// Standard fields.
				"([^\"\\" + strDelimiter + "\\r\\n]*))"
			),
			"gi"
			);


		// Create an array to hold our data. Give the array
		// a default empty first row.
		let arrData = [[]];//ç©ºã®é…åˆ—ã‚’ç”¨æ„
        //console.log(arrData);

		// Create an array to hold our individual pattern
		// matching groups.
		var arrMatches = null;

		// Keep looping over the regular expression matches
		// until we can no longer find a match.
		while (arrMatches = objPattern.exec( strData )){//exec() ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—å†…ã§ä¸€è‡´ã™ã‚‹ã‚‚ã®ã®æ¤œç´¢ã‚’å®Ÿè¡Œ

			// Get the delimiter that was found.
			var strMatchedDelimiter = arrMatches[ 1 ];

			// Check to see if the given delimiter has a length
			// (is not the start of string) and if it matches
			// field delimiter. If id does not, then we know
			// that this delimiter is a row delimiter.
			if (
				strMatchedDelimiter.length &&
				(strMatchedDelimiter != strDelimiter)
				){

				// Since we have reached a new row of data,
				// add an empty row to our data array.
				arrData.push( [] );
			}

			// Now that we have our delimiter out of the way,
			// let's check to see which kind of value we
			// captured (quoted or unquoted).
			if (arrMatches[ 2 ]){
				// We found a quoted value. When we capture
				// this value, unescape any double quotes.
				var strMatchedValue = arrMatches[ 2 ].replace(
					new RegExp( "\"\"", "g" ),
					"\""
					);

			} else {

				// We found a non-quoted value.
				var strMatchedValue = arrMatches[ 3 ];
			}

			// Now that we have our value string, let's add
			// it to the data array.
			arrData[ arrData.length - 1 ].push( strMatchedValue );
		    }

		    // Return the parsed data.
		    return( arrData );
	        }
        
        
         
    
    

    
    </script>


 
    

<footer>
    <nav class="header_menu">
        <a href="index.html" class="menu_item"><span>å€™è£œè€…</span><span>ä¸€è¦§</span></a>
        <a href="compare.html" class="menu_item">è³ªå•ã”ã¨ã«æ¯”è¼ƒã™ã‚‹</a>               
        <!--<a href="early_voting_map.html" class="menu_item"><span>æœŸæ—¥å‰</span><span>æŠ•ç¥¨ã«ã¤ã„ã¦</span></a>
        <a href="" class="menu_item"><span>æŠ•ç¥¨æ‰€</span><span>ã«ã¤ã„ã¦</span></a>-->            
        <a href="about_us.html" class="menu_item">About us</a>
    </nav>
    <p class="copyright">Â© All rights reserved by å­è‚²ã¦ç’°å¢ƒå‘ä¸Šå§”å“¡ä¼š@ä¸­é‡</p>
</footer>
</body>

</html>